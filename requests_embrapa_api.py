from fastapi import FastAPI
import requests
import pandas as pd

app = FastAPI()

@app.get("/embrapa_producao/")
def extracao_producao_ano():
    url = "http://vitibrasil.cnpuv.embrapa.br/download/Producao.csv"
    df = pd.read_csv(url, delimiter=';', header=None, skiprows=1)

    df.columns = ["id",
                    "control",
                    "produto",
                    "1970",
                    "1971",
                    "1972",
                    "1973",
                    "1974",
                    "1975",
                    "1976",
                    "1977",
                    "1978",
                    "1979",
                    "1980",
                    "1981",
                    "1982",
                    "1983",
                    "1984",
                    "1985",
                    "1986",
                    "1987",
                    "1988",
                    "1989",
                    "1990",
                    "1991",
                    "1992",
                    "1993",
                    "1994",
                    "1995",
                    "1996",
                    "1997",
                    "1998",
                    "1999",
                    "2000",
                    "2001",
                    "2002",
                    "2003",
                    "2004",
                    "2005",
                    "2006",
                    "2007",
                    "2008",
                    "2009",
                    "2010",
                    "2011",
                    "2012",
                    "2013",
                    "2014",
                    "2015",
                    "2016",
                    "2017",
                    "2018",
                    "2019",
                    "2020",
                    "2021",
                    "2022",
                    "2023"]

    df = df.drop(columns=['id'])

    dict_data = df.to_dict('records')

    return {"message": dict_data}

@app.post("/embrapa_processamento/")
def extracao_processamento(processamento):
    url = f"http://vitibrasil.cnpuv.embrapa.br/download/{processamento}.csv"
    df = pd.read_csv(url, delimiter='\t', header=None, skiprows=1)

    # Renomear as colunas
    df.columns = ["id",
                    "control",
                    "cultivar",
                    "1970",
                    "1971",
                    "1972",
                    "1973",
                    "1974",
                    "1975",
                    "1976",
                    "1977",
                    "1978",
                    "1979",
                    "1980",
                    "1981",
                    "1982",
                    "1983",
                    "1984",
                    "1985",
                    "1986",
                    "1987",
                    "1988",
                    "1989",
                    "1990",
                    "1991",
                    "1992",
                    "1993",
                    "1994",
                    "1995",
                    "1996",
                    "1997",
                    "1998",
                    "1999",
                    "2000",
                    "2001",
                    "2002",
                    "2003",
                    "2004",
                    "2005",
                    "2006",
                    "2007",
                    "2008",
                    "2009",
                    "2010",
                    "2011",
                    "2012",
                    "2013",
                    "2014",
                    "2015",
                    "2016",
                    "2017",
                    "2018",
                    "2019",
                    "2020",
                    "2021",
                    "2022",
    ]

    df = df.drop(columns=['id'])

    dict_data = df.to_dict('records')

    return {"message": dict_data}

@app.get("/embrapa_comercial/")
def extracao_comercial():
    url = "http://vitibrasil.cnpuv.embrapa.br/download/Comercio.csv"
    df = pd.read_csv(url, delimiter=';', header=None, skiprows=1)

    # Renomear as colunas
    df.columns = ["id",
                    "control",
                    "produto",
                    "1970",
                    "1971",
                    "1972",
                    "1973",
                    "1974",
                    "1975",
                    "1976",
                    "1977",
                    "1978",
                    "1979",
                    "1980",
                    "1981",
                    "1982",
                    "1983",
                    "1984",
                    "1985",
                    "1986",
                    "1987",
                    "1988",
                    "1989",
                    "1990",
                    "1991",
                    "1992",
                    "1993",
                    "1994",
                    "1995",
                    "1996",
                    "1997",
                    "1998",
                    "1999",
                    "2000",
                    "2001",
                    "2002",
                    "2003",
                    "2004",
                    "2005",
                    "2006",
                    "2007",
                    "2008",
                    "2009",
                    "2010",
                    "2011",
                    "2012",
                    "2013",
                    "2014",
                    "2015",
                    "2016",
                    "2017",
                    "2018",
                    "2019",
                    "2020",
                    "2021",
                    "2022",
                    "2023"]

    df = df.drop(columns=['id'])

    dict_data = df.to_dict('records')

    return {"message": dict_data}

@app.post("/embrapa_importacao/")
def extracao_importacao(importacao_produto):
    url = "http://vitibrasil.cnpuv.embrapa.br/download/{importacao_produto}.csv"

    #http://vitibrasil.cnpuv.embrapa.br/download/ImpVinhos.csv
    #http://vitibrasil.cnpuv.embrapa.br/download/ImpVinhos.csv
    #http://vitibrasil.cnpuv.embrapa.br/download/ImpFrescas.csv
    #http://vitibrasil.cnpuv.embrapa.br/download/ImpPassas.csv
    #http://vitibrasil.cnpuv.embrapa.br/download/ImpSuco.csv

    df = pd.read_csv(url, delimiter=';', header=None, skiprows=1)

    df.columns = ["id",
            "pais",
            "qtde_kg_1970",
            "valor_usd_1970",
            "qtde_kg_1971",
            "valor_usd_1971",
            "qtde_kg_1972",
            "valor_usd_1972",
            "qtde_kg_1973",
            "valor_usd_1973",
            "qtde_kg_1974",
            "valor_usd_1974",
            "qtde_kg_1975",
            "valor_usd_1975",
            "qtde_kg_1976",
            "valor_usd_1976",
            "qtde_kg_1977",
            "valor_usd_1977",
            "qtde_kg_1978",
            "valor_usd_1978",
            "qtde_kg_1979",
            "valor_usd_1979",
            "qtde_kg_1980",
            "valor_usd_1980",
            "qtde_kg_1981",
            "valor_usd_1981",
            "qtde_kg_1982",
            "valor_usd_1982",
            "qtde_kg_1983",
            "valor_usd_1983",
            "qtde_kg_1984",
            "valor_usd_1984",
            "qtde_kg_1985",
            "valor_usd_1985",
            "qtde_kg_1986",
            "valor_usd_1986",
            "qtde_kg_1987",
            "valor_usd_1987",
            "qtde_kg_1988",
            "valor_usd_1988",
            "qtde_kg_1989",
            "valor_usd_1989",
            "qtde_kg_1990",
            "valor_usd_1990",
            "qtde_kg_1991",
            "valor_usd_1991",
            "qtde_kg_1992",
            "valor_usd_1992",
            "qtde_kg_1993",
            "valor_usd_1993",
            "qtde_kg_1994",
            "valor_usd_1994",
            "qtde_kg_1995",
            "valor_usd_1995",
            "qtde_kg_1996",
            "valor_usd_1996",
            "qtde_kg_1997",
            "valor_usd_1997",
            "qtde_kg_1998",
            "valor_usd_1998",
            "qtde_kg_1999",
            "valor_usd_1999",
            "qtde_kg_2000",
            "valor_usd_2000",
            "qtde_kg_2001",
            "valor_usd_2001",
            "qtde_kg_2002",
            "valor_usd_2002",
            "qtde_kg_2003",
            "valor_usd_2003",
            "qtde_kg_2004",
            "valor_usd_2004",
            "qtde_kg_2005",
            "valor_usd_2005",
            "qtde_kg_2006",
            "valor_usd_2006",
            "qtde_kg_2007",
            "valor_usd_2007",
            "qtde_kg_2008",
            "valor_usd_2008",
            "qtde_kg_2009",
            "valor_usd_2009",
            "qtde_kg_2010",
            "valor_usd_2010",
            "qtde_kg_2011",
            "valor_usd_2011",
            "qtde_kg_2012",
            "valor_usd_2012",
            "qtde_kg_2013",
            "valor_usd_2013",
            "qtde_kg_2014",
            "valor_usd_2014",
            "qtde_kg_2015",
            "valor_usd_2015",
            "qtde_kg_2016",
            "valor_usd_2016",
            "qtde_kg_2017",
            "valor_usd_2017",
            "qtde_kg_2018",
            "valor_usd_2018",
            "qtde_kg_2019",
            "valor_usd_2019",
            "qtde_kg_2020",
            "valor_usd_2020",
            "qtde_kg_2021",
            "valor_usd_2021",
            "qtde_kg_2022",
            "valor_usd_2022",
            "qtde_kg_2023",
            "valor_usd_2023"]
    
    df = df.drop(columns=['id'])

    dict_data = df.to_dict('records')

    return {"message": dict_data}


@app.post("/embrapa_exportacao/")
def extracao_exportacao(exportacao_produto):

    url = 'http://vitibrasil.cnpuv.embrapa.br/download/ExpSuco.csv'

    #'http://vitibrasil.cnpuv.embrapa.br/download/ExpUva.csv'
    #'http://vitibrasil.cnpuv.embrapa.br/download/ExpEspumantes.csv'
    #"http://vitibrasil.cnpuv.embrapa.br/download/ExpVinho.csv"


    df = pd.read_csv(url, delimiter=';', header=None, skiprows=1)

    df.columns = ["id",
            "pais",
            "qtde_kg_1970",
            "valor_usd_1970",
            "qtde_kg_1971",
            "valor_usd_1971",
            "qtde_kg_1972",
            "valor_usd_1972",
            "qtde_kg_1973",
            "valor_usd_1973",
            "qtde_kg_1974",
            "valor_usd_1974",
            "qtde_kg_1975",
            "valor_usd_1975",
            "qtde_kg_1976",
            "valor_usd_1976",
            "qtde_kg_1977",
            "valor_usd_1977",
            "qtde_kg_1978",
            "valor_usd_1978",
            "qtde_kg_1979",
            "valor_usd_1979",
            "qtde_kg_1980",
            "valor_usd_1980",
            "qtde_kg_1981",
            "valor_usd_1981",
            "qtde_kg_1982",
            "valor_usd_1982",
            "qtde_kg_1983",
            "valor_usd_1983",
            "qtde_kg_1984",
            "valor_usd_1984",
            "qtde_kg_1985",
            "valor_usd_1985",
            "qtde_kg_1986",
            "valor_usd_1986",
            "qtde_kg_1987",
            "valor_usd_1987",
            "qtde_kg_1988",
            "valor_usd_1988",
            "qtde_kg_1989",
            "valor_usd_1989",
            "qtde_kg_1990",
            "valor_usd_1990",
            "qtde_kg_1991",
            "valor_usd_1991",
            "qtde_kg_1992",
            "valor_usd_1992",
            "qtde_kg_1993",
            "valor_usd_1993",
            "qtde_kg_1994",
            "valor_usd_1994",
            "qtde_kg_1995",
            "valor_usd_1995",
            "qtde_kg_1996",
            "valor_usd_1996",
            "qtde_kg_1997",
            "valor_usd_1997",
            "qtde_kg_1998",
            "valor_usd_1998",
            "qtde_kg_1999",
            "valor_usd_1999",
            "qtde_kg_2000",
            "valor_usd_2000",
            "qtde_kg_2001",
            "valor_usd_2001",
            "qtde_kg_2002",
            "valor_usd_2002",
            "qtde_kg_2003",
            "valor_usd_2003",
            "qtde_kg_2004",
            "valor_usd_2004",
            "qtde_kg_2005",
            "valor_usd_2005",
            "qtde_kg_2006",
            "valor_usd_2006",
            "qtde_kg_2007",
            "valor_usd_2007",
            "qtde_kg_2008",
            "valor_usd_2008",
            "qtde_kg_2009",
            "valor_usd_2009",
            "qtde_kg_2010",
            "valor_usd_2010",
            "qtde_kg_2011",
            "valor_usd_2011",
            "qtde_kg_2012",
            "valor_usd_2012",
            "qtde_kg_2013",
            "valor_usd_2013",
            "qtde_kg_2014",
            "valor_usd_2014",
            "qtde_kg_2015",
            "valor_usd_2015",
            "qtde_kg_2016",
            "valor_usd_2016",
            "qtde_kg_2017",
            "valor_usd_2017",
            "qtde_kg_2018",
            "valor_usd_2018",
            "qtde_kg_2019",
            "valor_usd_2019",
            "qtde_kg_2020",
            "valor_usd_2020",
            "qtde_kg_2021",
            "valor_usd_2021",
            "qtde_kg_2022",
            "valor_usd_2022",
            "qtde_kg_2023",
            "valor_usd_2023"]

    df = df.drop(columns=['id'])

    dict_data = df.to_dict('records')

    return {"message": dict_data}